<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>iqmedi documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	    <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">iqmedi documentation</a>
            <button type="button" class="btn btn-default btn-menu fa fa-bars" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
            <div id="book-search-input" role="search">
                <input type="text" placeholder="Type to search">
            </div>
            <nav>
            
                <ul class="list">
            
                    <li class="title">
                        <a href="../">iqmedi documentation</a>
                    </li>
            
                    <li class="divider"></li>
            
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../"><span class="fa fa-home"></span>Getting started</a>
                        <ul class="links">
                                <li class="link">
                                    <a href="../" ><span class="fa fa-file-text-o"></span>README</a>
                                </li>
                                <li class="link">
                                    <a 
                                        
                                         href="../overview.html" 
                                         href="../overview.html" 
                                        >
                                        <span class="fa fa-th"></span>Overview
                                    </a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="./modules.html" >
                            <span class="fa fa-archive"></span>
                            <span>Modules</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-modules-links"
                            ></span>
                        </a>
                        <ul class="links collapse in"
                                id="xs-modules-links"
                            >
                                <li class="link">
                                    <a href="../modules/AppModule.html" >AppModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/AppRoutingModule.html" >AppRoutingModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/HomeModule.html" >HomeModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/HomeRoutingModule.html" >HomeRoutingModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/WorkModule.html" >WorkModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/WorkRoutingModule.html" >WorkRoutingModule</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-cogs"></span>
                            <span>Components</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-components-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-components-links"
                            >
                                <li class="link">
                                    <a href="../components/AppComponent.html" >AppComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/EstudianteComponent.html" >EstudianteComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/HomeComponent.html" >HomeComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SaludoComponent.html" >SaludoComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/WorkComponent.html" >WorkComponent</a>
                                </li>
                        </ul>
                    </li>
            
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-file-code-o"></span>
                            <span>Classes</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-classes-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-classes-links"
                            >
                                <li class="link">
                                    <a href="../classes/Cuestionarioevaluado.html" >Cuestionarioevaluado</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Estudiante.html" >Estudiante</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/IqmediPage.html" >IqmediPage</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Puntajecuestionario.html" >Puntajecuestionario</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Usuario.html" >Usuario</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../routes.html" ><span class="fa fa-code-fork"></span>Routes</a>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-long-arrow-down"></span>
                            <span>Injectables</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-injectables-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-injectables-links"
                            >
                                <li class="link">
                                    <a href="../injectables/AppService.html"  class="active" >AppService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/AuthService.html" >AuthService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/Authexitguard.html" >Authexitguard</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/Authguard.html" >Authguard</a>
                                </li>
                        </ul>
                    </li>
            
            
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../miscellaneous.html" ><span class="fa fa-cubes"></span>Miscellaneous</a>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../coverage.html" ><span class="fa fa-tasks"></span>Documentation coverage</a>
                    </li>
            
                    <li class="divider"></li>
                    <li class="copyright">
                            Documentation generated using <a href="https://compodoc.github.io/compodoc/" target="_blank">
                                        <img src="..//images/compodoc-vectorise.svg" class="img-responsive">
                            </a>
                    </li>
            
                </ul>
            
            </nav>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <nav>
                   
                       <ul class="list">
                   
                           <li class="title">
                               <a href="../">iqmedi documentation</a>
                           </li>
                   
                           <li class="divider"></li>
                   
                               <div id="book-search-input" role="search">
                                   <input type="text" placeholder="Type to search">
                               </div>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../"><span class="fa fa-home"></span>Getting started</a>
                               <ul class="links">
                                       <li class="link">
                                           <a href="../" ><span class="fa fa-file-text-o"></span>README</a>
                                       </li>
                                       <li class="link">
                                           <a 
                                               
                                                href="../overview.html" 
                                                href="../overview.html" 
                                               >
                                               <span class="fa fa-th"></span>Overview
                                           </a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="./modules.html" >
                                   <span class="fa fa-archive"></span>
                                   <span>Modules</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#modules-links"
                                   ></span>
                               </a>
                               <ul class="links collapse in"
                                       id="modules-links"
                   >
                                       <li class="link">
                                           <a href="../modules/AppModule.html" >AppModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/AppRoutingModule.html" >AppRoutingModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/HomeModule.html" >HomeModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/HomeRoutingModule.html" >HomeRoutingModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/WorkModule.html" >WorkModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/WorkRoutingModule.html" >WorkRoutingModule</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-cogs"></span>
                                   <span>Components</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#components-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="components-links"
                   >
                                       <li class="link">
                                           <a href="../components/AppComponent.html" >AppComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/EstudianteComponent.html" >EstudianteComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/HomeComponent.html" >HomeComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SaludoComponent.html" >SaludoComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/WorkComponent.html" >WorkComponent</a>
                                       </li>
                               </ul>
                           </li>
                   
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-file-code-o"></span>
                                   <span>Classes</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#classes-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="classes-links"
                   >
                                       <li class="link">
                                           <a href="../classes/Cuestionarioevaluado.html" >Cuestionarioevaluado</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Estudiante.html" >Estudiante</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/IqmediPage.html" >IqmediPage</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Puntajecuestionario.html" >Puntajecuestionario</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Usuario.html" >Usuario</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../routes.html" ><span class="fa fa-code-fork"></span>Routes</a>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-long-arrow-down"></span>
                                   <span>Injectables</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#injectables-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="injectables-links"
                   >
                                       <li class="link">
                                           <a href="../injectables/AppService.html"  class="active" >AppService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/AuthService.html" >AuthService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/Authexitguard.html" >Authexitguard</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/Authguard.html" >Authguard</a>
                                       </li>
                               </ul>
                           </li>
                   
                   
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../miscellaneous.html" ><span class="fa fa-cubes"></span>Miscellaneous</a>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../coverage.html" ><span class="fa fa-tasks"></span>Documentation coverage</a>
                           </li>
                   
                           <li class="divider"></li>
                           <li class="copyright">
                                   Documentation generated using <a href="https://compodoc.github.io/compodoc/" target="_blank">
                                               <img src="..//images/compodoc-vectorise.svg" class="img-responsive">
                                   </a>
                           </li>
                   
                       </ul>
                   
                   </nav>
               </div>
               <div class="content injectable">
                   <div class="content-data">




<ol class="breadcrumb">
  <li>Injectables</li>
  <li>AppService</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
    <li class="active">
        <a href="#infos" id="infos-tab" role="tab" data-toggle="tab">Infos</a>
    </li>
    <li>
        <a href="#source" role="tab" id="source-tab" data-toggle="tab">Source</a>
    </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="infos">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/app.service.ts</code>
        </p>


            <section>
                <h3 id="constructor">Constructor</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <code>constructor(df: AngularFireDatabase, abfauth: AngularFireAuth, authService: <a href="../injectables/AuthService.html" >AuthService</a>)</code>
                                </td>
                            </tr>
            
                        </tbody>
                    </table>
            </section>

            <section>
                <h3 id="methods">Methods</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> setUsuario</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>setUsuario(usuario: <a href="../classes/Usuario.html" >Usuario</a>)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>usuario</b>
                                                                    :     <code><a href="../classes/Usuario.html" target="_self" >Usuario</a></code>
            
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> setEstudiante</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>setEstudiante(estudiante: <a href="../classes/Estudiante.html" >Estudiante</a>)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>estudiante</b>
                                                                    :     <code><a href="../classes/Estudiante.html" target="_self" >Estudiante</a></code>
            
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> getUsuario</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>getUsuario(usuario: <a href="../classes/Usuario.html" >Usuario</a>)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>usuario</b>
                                                                    :     <code><a href="../classes/Usuario.html" target="_self" >Usuario</a></code>
            
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                <p>* </p>
            
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> getEstudiantes</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>getEstudiantes(usuario: <a href="../classes/Usuario.html" >Usuario</a>)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>usuario</b>
                                                                    :     <code><a href="../classes/Usuario.html" target="_self" >Usuario</a></code>
            
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                <p>* </p>
            
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> getTest</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>getTest()</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>estudiante</b>
                                                                    :     <code><a href="../classes/Estudiante.html" target="_self" >Estudiante</a></code>
            
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                <p>* </p>
            
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> getTestMateriales</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>getTestMateriales(test: any)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>test</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                <p>* </p>
            
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> getTestEvaluado</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>getTestEvaluado(usuario: <a href="../classes/Usuario.html" >Usuario</a>, estudiante: any)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> getSubTest</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>getSubTest(test: any)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>test</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                <p>* </p>
            
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> getPregunta</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>getPregunta(test: any, numero_pregunta: number)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>test</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>numero_pregunta</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                <p>* </p>
            
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> getPreguntaRespuesta</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>getPreguntaRespuesta(test: any, numero_pregunta: number)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>test</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>numero_pregunta</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                <p>* </p>
            
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> getResultadoCategoria</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>getResultadoCategoria(usuario: <a href="../classes/Usuario.html" >Usuario</a>, estudiante: any, testid: String)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> getTestCalificado</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>getTestCalificado(usuario: <a href="../classes/Usuario.html" >Usuario</a>, estudiante: any, testid: String)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> getEstudiantesFiltroCi</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>getEstudiantesFiltroCi(usuario: <a href="../classes/Usuario.html" >Usuario</a>, ci: number)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>usuario</b>
                                                                    :     <code><a href="../classes/Usuario.html" target="_self" >Usuario</a></code>
            
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>ci</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                <p>* </p>
            
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> getEstudiantesFiltroNombres</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>getEstudiantesFiltroNombres(usuario: <a href="../classes/Usuario.html" >Usuario</a>, nombres: string)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>usuario</b>
                                                                    :     <code><a href="../classes/Usuario.html" target="_self" >Usuario</a></code>
            
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>nombres</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                <p>* </p>
            
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> getEstudiantesFiltroApellidos</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>getEstudiantesFiltroApellidos(usuario: <a href="../classes/Usuario.html" >Usuario</a>, apellidos: string)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>usuario</b>
                                                                    :     <code><a href="../classes/Usuario.html" target="_self" >Usuario</a></code>
            
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>apellidos</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                <p>* </p>
            
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> getPuntosEquivalentes</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>getPuntosEquivalentes(tipo_pregunta: string, meses: number, puntaje: number, test: any)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>tipo_pregunta</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>meses</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>puntaje</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>test</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                <p>* </p>
            
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> pushChildUltimoAcceso</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>pushChildUltimoAcceso(usuario: <a href="../classes/Usuario.html" >Usuario</a>)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>usuario</b>
                                                                    :     <code><a href="../classes/Usuario.html" target="_self" >Usuario</a></code>
            
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> updateEstudiante</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>updateEstudiante(estudiante: <a href="../classes/Estudiante.html" >Estudiante</a>)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>estudiante</b>
                                                                    :     <code><a href="../classes/Estudiante.html" target="_self" >Estudiante</a></code>
            
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> deleteEstudiante</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>deleteEstudiante(key: string)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>key</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> calificarTestZazzo</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>calificarTestZazzo(mr: number, puntaje: number, resultadopregunta: <a href="../classes/Cuestionarioevaluado.html" >Cuestionarioevaluado[]</a>, resultadocuest: <a href="../classes/Puntajecuestionario.html" >Puntajecuestionario[]</a>, resultadocuestcat: <a href="../classes/Puntajecuestionario.html" >Puntajecuestionario[]</a>, test: any, estudiante: any, usuario: <a href="../classes/Usuario.html" >Usuario</a>, fecha: String)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>mr</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>puntaje</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>resultadopregunta</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>resultadocuest</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>resultadocuestcat</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>test</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>estudiante</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>usuario</b>
                                                                    :     <code><a href="../classes/Usuario.html" target="_self" >Usuario</a></code>
            
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>fecha</b>
                                                                    :     <code>String</code>
            
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                <p>* </p>
            
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> calificarTestWisc</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
            <code>calificarTestWisc(mr: number, puntaje: number, resultadopregunta: <a href="../classes/Cuestionarioevaluado.html" >Cuestionarioevaluado[]</a>, resultadocuest: <a href="../classes/Puntajecuestionario.html" >Puntajecuestionario[]</a>, resultadocuestcat: <a href="../classes/Puntajecuestionario.html" >Puntajecuestionario[]</a>, test: any, estudiante: any, usuario: <a href="../classes/Usuario.html" >Usuario</a>, fecha: String)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>mr</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>puntaje</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>resultadopregunta</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>resultadocuest</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>resultadocuestcat</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>test</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>estudiante</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>usuario</b>
                                                                    :     <code><a href="../classes/Usuario.html" target="_self" >Usuario</a></code>
            
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>fecha</b>
                                                                    :     <code>String</code>
            
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                <p>* </p>
            
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b><span class="modifier">Public</span> export</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <span class="modifier-icon method fa fa-play circle">
                                            <span class="fa fa-circle"></span>
                                        </span>
                                    <code>export(usuario: <a href="../classes/Usuario.html" >Usuario</a>, estudiante: any, testeval: string)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>usuario</b>
                                                                    :     <code><a href="../classes/Usuario.html" target="_self" >Usuario</a></code>
            
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>estudiante</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>testeval</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b><span class="modifier">Private</span> exportAsExcelFile</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <span class="modifier-icon method fa fa-play lock">
                                            <span class="fa fa-lock"></span>
                                        </span>
                                    <code>exportAsExcelFile(datospersonales: any[], datosrespuesta: any[], datosrespuestatipo: any[], datosrespuestacate: any[], datosresultado: any[], excelFileName: string)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>resultadospresg</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>excelFileName</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b><span class="modifier">Private</span> wrapAndCenterCell</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <span class="modifier-icon method fa fa-play lock">
                                            <span class="fa fa-lock"></span>
                                        </span>
                                    <code>wrapAndCenterCell(cell: any)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>cell</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b><span class="modifier">Private</span> setCellStyle</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <span class="modifier-icon method fa fa-play lock">
                                            <span class="fa fa-lock"></span>
                                        </span>
                                    <code>setCellStyle(cell: any, style: {})</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>cell</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>style</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b><span class="modifier">Private</span> saveAsExcelFile</b>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <span class="modifier-icon method fa fa-play lock">
                                            <span class="fa fa-lock"></span>
                                        </span>
                                    <code>saveAsExcelFile(buffer: any, fileName: string)</code>
                                </td>
                            </tr>
            
                            <tr>
                                <td class="col-md-4">
                                        <div class="io-description">
                                                <b>Parameters :</b>
                                                <ul class="jsdoc-params">
                                                        <li>
                                                            <div>
                                                                <b>buffer</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                        <li>
                                                            <div>
                                                                <b>fileName</b>
                                                            </div>
                                                            <div>
                                                                
                                                            </div>
                                                        </li>
                                                </ul>
                                        </div>
                                        <div class="io-description">
                                            <b>Returns: </b>    <code>void</code>
            
                                        </div>
                                            <div class="io-description">
                                                
                                            </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
            </section>

            <section>
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> estudiantes</b>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-md-4">
                                    <code>estudiantes:     <code>FirebaseListObservable&lt;any[]&gt;</code>
            </bcode>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> material</b>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-md-4">
                                    <code>material:     <code>FirebaseListObservable&lt;any[]&gt;</code>
            </bcode>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> mensaje</b>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-md-4">
                                    <code>mensaje:     <code>string</code>
            </bcode>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> pregunta</b>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-md-4">
                                    <code>pregunta:     <code>FirebaseListObservable&lt;any[]&gt;</code>
            </bcode>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> puntajeCategoria</b>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-md-4">
                                    <code>puntajeCategoria:     <code>FirebaseListObservable&lt;any[]&gt;</code>
            </bcode>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> respuesta</b>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-md-4">
                                    <code>respuesta:     <code>FirebaseListObservable&lt;any[]&gt;</code>
            </bcode>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> subtests</b>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-md-4">
                                    <code>subtests:     <code>FirebaseListObservable&lt;any[]&gt;</code>
            </bcode>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> testCalificado</b>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-md-4">
                                    <code>testCalificado:     <code>FirebaseListObservable&lt;any[]&gt;</code>
            </bcode>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> testevaluado</b>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-md-4">
                                    <code>testevaluado:     <code>FirebaseListObservable&lt;any[]&gt;</code>
            </bcode>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> tests</b>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-md-4">
                                    <code>tests:     <code>FirebaseListObservable&lt;any[]&gt;</code>
            </bcode>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                            <tr>
                                <td class="col-md-4">
                                    <b> usuario</b>
                                </td>
                            </tr>
                            <tr>
                                <td class="col-md-4">
                                    <code>usuario:     <code><a href="../classes/Usuario.html" target="_self" >Usuario</a></code>
            </bcode>
                                </td>
                            </tr>
                        </tbody>
                    </table>
            </section>
    </div>
    <div class="tab-pane fade tab-source-code" id="source">
        <pre><code class="hljs javascript">import { Injectable } from &#x27;@angular/core&#x27;;
import { Observable } from &#x27;rxjs/Observable&#x27;;
import { AngularFireDatabase, FirebaseListObservable } from &#x27;angularfire2/database&#x27;;

import { AuthService } from &#x27;./home/auth.service&#x27;;

import { AngularFireAuth } from &#x27;angularfire2/auth&#x27;;

import { Usuario } from &#x27;./modelos/usuario&#x27;;
import { Estudiante } from &#x27;./modelos/estudiante&#x27;;
import { Cuestionarioevaluado } from &#x27;./modelos/cuestionarioevaluado&#x27;;
import { Puntajecuestionario } from &#x27;./modelos/puntajecuestionario&#x27;;

import * as firebase from &#x27;firebase&#x27;;
import * as FileSaver from &#x27;file-saver&#x27;;
import * as XLSX from &#x27;xlsx&#x27;;
import * as XLSXStyle from &#x27;xlsx-style&#x27;;

const EXCEL_TYPE &#x3D; &#x27;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset&#x3D;UTF-8&#x27;;
const EXCEL_EXTENSION &#x3D; &#x27;.xlsx&#x27;;

/**
 *
 * @export
 * @class AppService
 */
@Injectable()
export class AppService {
  mensaje: string;
  usuario: Usuario;
  estudiantes: FirebaseListObservable&lt;any[]&gt;;
  tests: FirebaseListObservable&lt;any[]&gt;;
  testevaluado: FirebaseListObservable&lt;any[]&gt;;
  subtests: FirebaseListObservable&lt;any[]&gt;;
  pregunta: FirebaseListObservable&lt;any[]&gt;;
  respuesta: FirebaseListObservable&lt;any[]&gt;;
  material: FirebaseListObservable&lt;any[]&gt;;
  puntajeCategoria: FirebaseListObservable&lt;any[]&gt;;
  testCalificado: FirebaseListObservable&lt;any[]&gt;;

  constructor(
    private df: AngularFireDatabase,
    private abfauth: AngularFireAuth,
    private authService: AuthService) { }

  /**
   *
   * @param {Usuario} usuario
   * @memberof AppService
   */
  setUsuario(usuario: Usuario) {
    this.df.database.ref(&#x27;usuario/&#x27; + usuario.id).set({
      username: usuario.usuario,
      email: usuario.email,
      isactive: usuario.isactive
    });
  }

  /**
   *
   * @param {Estudiante} estudiante
   * @memberof AppService
   */
  setEstudiante(estudiante: Estudiante) {
    this.df.database.ref(&#x27;estudiante_usuario/&#x27; + estudiante.usuario).child(&#x27;estudiante&#x27;).push({
      ci: estudiante.ci,
      nombres: estudiante.nombres,
      apellidos: estudiante.apellidos,
      sexo: estudiante.sexo,
      fecha_nacimiento: estudiante.fecha_nacimiento,
      isactive: estudiante.isactive
    });
  }

  /**
   *
   * @param {Usuario} usuario
   * @returns
   * @memberof AppService
   */
  getUsuario (usuario: Usuario) {
    const resultado &#x3D; this.df.database.ref(&#x27;usuario&#x27;).orderByChild(&#x27;email&#x27;).equalTo(usuario.email).once(&#x27;value&#x27;)
      .then(function(snapshot) {
        snapshot.forEach(function (childSnapshot) {
            const auxvalue &#x3D; childSnapshot.val();
            usuario.usuario &#x3D; auxvalue.username;
            usuario.isactive &#x3D; auxvalue.isactive;
          }
        );
        return usuario;
      }
    );

    return resultado;
  }

  /**
   *
   * @param {Usuario} usuario
   * @returns
   * @memberof AppService
   */
  getEstudiantes(usuario: Usuario) {
    this.estudiantes &#x3D; this.df.list(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante&#x27;) as FirebaseListObservable&lt;any[]&gt;;
    return this.estudiantes;
  }

  /**
   *
   * @param {Estudiante} estudiante
   * @returns
   * @memberof AppService
   */
  getTest() {
    this.tests &#x3D; this.df.list(&#x27;test&#x27;) as FirebaseListObservable&lt;any[]&gt;;
    return this.tests;
  }

  /**
   *
   * @param {*} test
   * @returns
   * @memberof AppService
   */
  getTestMateriales(test: any) {
    this.material &#x3D; this.df.list(&#x27;test/&#x27; + test.$key + &#x27;/material&#x27;) as FirebaseListObservable&lt;any[]&gt;;
    return this.material;
  }

  getTestEvaluado(usuario: Usuario, estudiante: any) {
    this.testevaluado &#x3D; this.df.list(&#x27;estudiante_usuario/&#x27;
      + usuario.id + &#x27;/estudiante/&#x27;
      + estudiante.$key + &#x27;/testevaluado&#x27;) as FirebaseListObservable&lt;any[]&gt;;
    return this.testevaluado;
  }

  /**
   *
   * @param {*} test
   * @returns
   * @memberof AppService
   */
  getSubTest(test: any) {
    this.subtests &#x3D; this.df.list(&#x27;test/&#x27; + test.$key + &#x27;/subtest&#x27;, {
      query: {
        orderByChild: &#x27;tipo&#x27;
      }
    }) as FirebaseListObservable&lt;any[]&gt;;
    return this.subtests;
  }

  /**
   *
   * @param {*} test
   * @param {number} numero_pregunta
   * @returns
   * @memberof AppService
   */
  getPregunta(test: any, numero_pregunta: number) {
    this.pregunta &#x3D; this.df.list(&#x27;test/&#x27; + test.$key + &#x27;/pregunta&#x27;, {
      query: {
        orderByChild: &#x27;numero_pregunta&#x27;,
        equalTo: numero_pregunta
      }
    }) as FirebaseListObservable&lt;any[]&gt;;
    return this.pregunta;
  }

  /**
   *
   * @param {*} test
   * @param {number} numero_pregunta
   * @returns
   * @memberof AppService
   */
  getPreguntaRespuesta(test: any, numero_pregunta: number) {
    this.respuesta &#x3D; this.df.list(&#x27;test/&#x27; + test.$key + &#x27;/respuesta&#x27;, {
      query: {
        orderByChild: &#x27;numero_pregunta&#x27;,
        equalTo: numero_pregunta
      }
    }) as FirebaseListObservable&lt;any[]&gt;;
    return this.respuesta;
  }

  getResultadoCategoria(usuario: Usuario, estudiante: any, testid: String) {
    this.puntajeCategoria &#x3D; this.df.list(&#x27;estudiante_usuario/&#x27;
      + usuario.id + &#x27;/estudiante/&#x27;
      + estudiante.$key + &#x27;/testevaluado/&#x27;
      + testid + &#x27;/puntajecategoria&#x27;) as FirebaseListObservable&lt;any[]&gt;;

    return this.puntajeCategoria;
  }

  getTestCalificado(usuario: Usuario, estudiante: any, testid: String) {
    this.testCalificado &#x3D; this.df.list(&#x27;estudiante_usuario/&#x27;
      + usuario.id + &#x27;/estudiante/&#x27;
      + estudiante.$key + &#x27;/testevaluado&#x27;, {
        query: {
          limitToLast: 1
        }
      }) as FirebaseListObservable&lt;any[]&gt;;

    return this.testCalificado;
  }

  /**
   *
   * @param {Usuario} usuario
   * @param {number} ci
   * @returns
   * @memberof AppService
   */
  getEstudiantesFiltroCi(usuario: Usuario, ci: number) {
    this.estudiantes &#x3D; this.df.list(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante&#x27;, {
      query: {
        orderByChild: &#x27;ci&#x27;,
        equalTo: ci
      }
    }) as FirebaseListObservable&lt;any[]&gt;;

    return this.estudiantes;
  }

  /**
   *
   * @param {Usuario} usuario
   * @param {string} nombres
   * @returns
   * @memberof AppService
   */
  getEstudiantesFiltroNombres(usuario: Usuario, nombres: string) {
    this.estudiantes &#x3D; this.df.list(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante&#x27;, {
      query: {
        orderByChild: &#x27;nombres&#x27;,
        // tslint:disable-next-line:radix
        equalTo: nombres
      }
    }) as FirebaseListObservable&lt;any[]&gt;;

    return this.estudiantes;
  }

  /**
   *
   * @param {Usuario} usuario
   * @param {string} apellidos
   * @returns
   * @memberof AppService
   */
  getEstudiantesFiltroApellidos(usuario: Usuario, apellidos: string) {
    this.estudiantes &#x3D; this.df.list(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante&#x27;, {
      query: {
        orderByChild: &#x27;apellidos&#x27;,
        // tslint:disable-next-line:radix
        equalTo: apellidos
      }
    }) as FirebaseListObservable&lt;any[]&gt;;

    return this.estudiantes;
  }

  /**
   *
   * @param {string} tipo_pregunta
   * @param {number} meses
   * @param {number} puntaje
   * @param {*} test
   * @returns
   * @memberof AppService
   */
  getPuntosEquivalentes(tipo_pregunta: string, meses: number, puntaje: number, test: any) {
    const resultado &#x3D; this.df.database.ref(&#x27;test/&#x27; +
    test.$key + &#x27;/escala_equivalente/&#x27; + tipo_pregunta)
      .orderByChild(&#x27;meses&#x27;)
      .endAt(meses)
      .once(&#x27;value&#x27;)
      .then(function(snapshot) {

        // tslint:disable-next-line:prefer-const
        let pequi &#x3D; 0;

        snapshot.forEach(function (childSnapshot) {
          const auxvalue &#x3D; childSnapshot.val();
            if (auxvalue.puntos &lt;&#x3D; puntaje) {
              pequi &#x3D; auxvalue.puntosequivalentes;
            }
          }
        );

        return pequi;
      }
    );

    return resultado;
  }

  /**
   *
   * @param {Usuario} usuario
   * @memberof AppService
   */
  pushChildUltimoAcceso(usuario: Usuario) {
    // tslint:disable-next-line:prefer-const
    /*let auxFecha &#x3D; new Date();
    this.df.database.ref(&#x27;usuario/&#x27; + usuario.id).child(&#x27;ultimoacceso&#x27;).push({
      fecha: auxFecha.toString()
    });*/

    /*this.df.database.ref(&#x27;/&#x27;).child(&#x27;test&#x27;).push({
      nombre: &#x27;WISC III&#x27;,
      isactive: usuario.isactive
    });*/

    // tslint:disable-next-line:prefer-const
    // tslint:disable-next-line:comment-format
    //let auxCabecera &#x3D; this.df.database.ref(&#x27;test/-KqMrJZ-UEASUXSbu-n8&#x27;);

    // tslint:disable-next-line:prefer-const
    // tslint:disable-next-line:comment-format
    //let auxCabecera &#x3D; this.df.database.ref(&#x27;test/-KqMrQPAJJ2H5Q1Pz01v&#x27;);


  }

  /**
   *
   * @param {Estudiante} estudiante
   * @memberof AppService
   */
  updateEstudiante(estudiante: Estudiante) {
    this.estudiantes.update(estudiante.id, {
      ci: estudiante.ci,
      nombres: estudiante.nombres,
      apellidos: estudiante.apellidos,
      fecha_nacimiento: estudiante.fecha_nacimiento,
      sexo: estudiante.sexo,
      isactive: estudiante.isactive
    });
  }

  /**
   *
   * @param {string} key
   * @memberof AppService
   */
  deleteEstudiante(key: string) {
    this.estudiantes.remove(key);
  }

  /**
   *
   * @param {number} mr
   * @param {number} puntaje
   * @param {Cuestionarioevaluado[]} resultadopregunta
   * @param {Puntajecuestionario[]} resultadocuest
   * @param {Puntajecuestionario[]} resultadocuestcat
   * @param {*} test
   * @param {*} estudiante
   * @param {Usuario} usuario
   * @param {String} fecha
   * @returns
   * @memberof AppService
   */
  calificarTestZazzo (
    mr: number,
    puntaje: number,
    resultadopregunta: Cuestionarioevaluado[],
    resultadocuest: Puntajecuestionario[],
    resultadocuestcat: Puntajecuestionario[],
    test: any,
    estudiante: any,
    usuario: Usuario,
    fecha: String
  ) {
    // tslint:disable-next-line:prefer-const
    let auxdf &#x3D; this.df;
    let cicalculado &#x3D; 0;
    let idrest &#x3D; &#x27;&#x27;;

    const resultado &#x3D; this.df.database.ref(&#x27;test/&#x27; +
      test.$key +
      &#x27;/escala&#x27;)
      .orderByChild(&#x27;puntos&#x27;)
      .limitToLast(1)
      .equalTo(puntaje)
      .once(&#x27;value&#x27;)
      .then(function(snapshot) {

        snapshot.forEach(function (childSnapshot) {
            const auxvalue &#x3D; childSnapshot.val();

            cicalculado &#x3D; Math.round((auxvalue.meses / mr) * 100);

            auxdf.database.ref(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante/&#x27; + estudiante.$key)
              .child(&#x27;edadmental&#x27;)
              .set(auxvalue.meses);

            auxdf.database.ref(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante/&#x27; + estudiante.$key)
              .child(&#x27;cicalculado&#x27;)
              .set(cicalculado);

            // tslint:disable-next-line:prefer-const
            let tsest &#x3D; auxdf.database.ref(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante/&#x27; + estudiante.$key)
              .child(&#x27;testevaluado&#x27;).push({
                fecha: fecha,
                puntajetotal: puntaje,
                tipo_test: test.$key
              }
            );

            tsest.child(&#x27;edadmental&#x27;).set(auxvalue.meses);
            tsest.child(&#x27;ci&#x27;).set(cicalculado);

            for (let k &#x3D; 0; k &lt; resultadopregunta.length; k++) {
              tsest.child(&#x27;respuestas&#x27;).push({
                numero_pregunta: resultadopregunta[k].numeropregunta,
                puntaje: resultadopregunta[k].puntaje,
                tiempo: resultadopregunta[k].tiempo
              });
            }

            for (let k &#x3D; 0; k &lt; resultadocuest.length; k++) {
              tsest.child(&#x27;puntajetipopregunta&#x27;).push({
                tipopregunta: resultadocuest[k].tipopregunta,
                puntaje: resultadocuest[k].puntaje
              });
            }

            for (let k &#x3D; 0; k &lt; resultadocuestcat.length; k++) {
              tsest.child(&#x27;puntajecategoria&#x27;).push({
                categoria: resultadocuestcat[k].categoria,
                puntaje: resultadocuestcat[k].puntaje
              });
            }

            auxdf.database.ref(&#x27;nivelcoeficiente&#x27;)
              .orderByChild(&#x27;ci&#x27;)
              .endAt(cicalculado)
              .limitToLast(1)
              .once(&#x27;value&#x27;)
              .then(function(auxsnapshot) {
                auxsnapshot.forEach(function (auxchildSnapshot) {
                  const auxvaluechild &#x3D; auxchildSnapshot.val();

                  auxdf.database.ref(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante/&#x27; + estudiante.$key)
                    .child(&#x27;nivelcognitivo&#x27;)
                    .set(auxvaluechild.estado);

                    tsest.child(&#x27;nivelcognitivo&#x27;).set(auxvaluechild.estado);
                }
                );
              }
            );
            idrest &#x3D; tsest.key;
          }
        );

        return idrest;
      }
    );

    if (puntaje &lt; 9) {
      auxdf.database.ref(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante/&#x27; + estudiante.$key)
      .child(&#x27;cicalculado&#x27;)
      .set(cicalculado);

      // tslint:disable-next-line:prefer-const
      let tsest &#x3D; this.df.database.ref(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante/&#x27; + estudiante.$key)
        .child(&#x27;testevaluado&#x27;).push({
          fecha: fecha,
          puntajetotal: puntaje,
          tipo_test: test.$key
        }
      );

      tsest.child(&#x27;ci&#x27;).set(0);

      for (let k &#x3D; 0; k &lt; resultadopregunta.length; k++) {
        tsest.child(&#x27;respuestas&#x27;).push({
          numero_pregunta: resultadopregunta[k].numeropregunta,
          puntaje: resultadopregunta[k].puntaje,
          tiempo: resultadopregunta[k].tiempo
        });
      }

      for (let k &#x3D; 0; k &lt; resultadocuest.length; k++) {
        tsest.child(&#x27;puntajetipopregunta&#x27;).push({
          tipopregunta: resultadocuest[k].tipopregunta,
          puntaje: resultadocuest[k].puntaje,
        });
      }

      for (let k &#x3D; 0; k &lt; resultadocuestcat.length; k++) {
        tsest.child(&#x27;puntajecategoria&#x27;).push({
          categoria: resultadocuestcat[k].categoria,
          puntaje: resultadocuestcat[k].puntaje
        });
      }

      idrest &#x3D; tsest.key;

      this.df.database.ref(&#x27;nivelcoeficiente&#x27;)
        .orderByChild(&#x27;ci&#x27;)
        .endAt(cicalculado)
        .once(&#x27;value&#x27;)
        .then(function(auxsnapshot) {
          auxsnapshot.forEach(function (auxchildSnapshot) {
            const auxvaluechild &#x3D; auxchildSnapshot.val();

            auxdf.database.ref(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante/&#x27; + estudiante.$key)
              .child(&#x27;nivelcognitivo&#x27;)
              .set(auxvaluechild.estado);

            auxdf.database.ref(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante/&#x27; + estudiante.$key)
              .child(&#x27;edadmental&#x27;)
              .set(null);

            tsest.child(&#x27;nivelcognitivo&#x27;).set(auxvaluechild.estado);

            return idrest;
          }
        );
      }
      );
    }

    return resultado;
  }

  /**
   *
   * @param {number} mr
   * @param {number} puntaje
   * @param {Cuestionarioevaluado[]} resultadopregunta
   * @param {Puntajecuestionario[]} resultadocuest
   * @param {Puntajecuestionario[]} resultadocuestcat
   * @param {*} test
   * @param {*} estudiante
   * @param {Usuario} usuario
   * @param {String} fecha
   * @returns
   * @memberof AppService
   */
  calificarTestWisc (
    mr: number,
    puntaje: number,
    resultadopregunta: Cuestionarioevaluado[],
    resultadocuest: Puntajecuestionario[],
    resultadocuestcat: Puntajecuestionario[],
    test: any,
    estudiante: any,
    usuario: Usuario,
    fecha: String
  ) {
    // tslint:disable-next-line:prefer-const
    let auxdf &#x3D; this.df;
    let edadmental &#x3D; 0;
    let idrest &#x3D; &#x27;&#x27;;

    const resultado &#x3D; this.df.database.ref(&#x27;test/&#x27;
      + test.$key
      + &#x27;/escala&#x27;)
      .orderByChild(&#x27;puntos&#x27;)
      .equalTo(puntaje)
      .once(&#x27;value&#x27;)
      .then(function(snapshot) {

        snapshot.forEach(function (childSnapshot) {
            const auxvalue &#x3D; childSnapshot.val();

            edadmental &#x3D; Math.round((auxvalue.ci / 100) * mr);

            auxdf.database.ref(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante/&#x27; + estudiante.$key)
              .child(&#x27;edadmental&#x27;)
              .set(edadmental);

            auxdf.database.ref(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante/&#x27; + estudiante.$key)
              .child(&#x27;cicalculado&#x27;)
              .set(auxvalue.ci);

              // tslint:disable-next-line:prefer-const
              let tsest &#x3D; auxdf.database.ref(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante/&#x27; + estudiante.$key)
                .child(&#x27;testevaluado&#x27;).push({
                  fecha: fecha,
                  puntajetotal: puntaje,
                  tipo_test: test.$key
                }
              );

              tsest.child(&#x27;edadmental&#x27;).set(edadmental);
              tsest.child(&#x27;ci&#x27;).set(auxvalue.ci);

              for (let k &#x3D; 0; k &lt; resultadopregunta.length; k++) {
                tsest.child(&#x27;respuestas&#x27;).push({
                  numero_pregunta: resultadopregunta[k].numeropregunta,
                  puntaje: resultadopregunta[k].puntaje,
                  tiempo: resultadopregunta[k].tiempo
                });
              }

              for (let k &#x3D; 0; k &lt; resultadocuest.length; k++) {
                tsest.child(&#x27;puntajetipopregunta&#x27;).push({
                  tipopregunta: resultadocuest[k].tipopregunta,
                  puntaje: resultadocuest[k].puntaje,
                  puntosequivalentes: resultadocuest[k].puntosequivalentes
                });
              }

              for (let k &#x3D; 0; k &lt; resultadocuestcat.length; k++) {
                tsest.child(&#x27;puntajecategoria&#x27;).push({
                  categoria: resultadocuestcat[k].categoria,
                  puntaje: resultadocuestcat[k].puntaje
                });
              }

              auxdf.database.ref(&#x27;nivelcoeficiente&#x27;)
                .orderByChild(&#x27;ci&#x27;)
                .endAt(auxvalue.ci)
                .once(&#x27;value&#x27;)
                .then(function(auxsnapshot) {
                auxsnapshot.forEach(function (auxchildSnapshot) {
                  const auxvaluechild &#x3D; auxchildSnapshot.val();

                  auxdf.database.ref(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante/&#x27; + estudiante.$key)
                    .child(&#x27;nivelcognitivo&#x27;)
                    .set(auxvaluechild.estado);

                    tsest.child(&#x27;nivelcognitivo&#x27;).set(auxvaluechild.estado);
                }
                );
              }
            );
            idrest &#x3D; tsest.key;
          }
        );
        return idrest;
      }
    );

    if (puntaje &lt; 10) {
      auxdf.database.ref(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante/&#x27; + estudiante.$key)
      .child(&#x27;cicalculado&#x27;)
      .set(puntaje);

      // tslint:disable-next-line:prefer-const
      let tsest &#x3D; this.df.database.ref(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante/&#x27; + estudiante.$key)
        .child(&#x27;testevaluado&#x27;).push({
          fecha: fecha,
          puntajetotal: puntaje,
          tipo_test: test.$key
        }
      );

      tsest.child(&#x27;ci&#x27;).set(0);

      for (let k &#x3D; 0; k &lt; resultadopregunta.length; k++) {
        tsest.child(&#x27;respuestas&#x27;).push({
          numero_pregunta: resultadopregunta[k].numeropregunta,
          puntaje: resultadopregunta[k].puntaje,
          tiempo: resultadopregunta[k].tiempo
        });
      }

      for (let k &#x3D; 0; k &lt; resultadocuest.length; k++) {
        tsest.child(&#x27;puntajetipopregunta&#x27;).push({
          tipopregunta: resultadocuest[k].tipopregunta,
          puntaje: resultadocuest[k].puntaje,
        });
      }

      for (let k &#x3D; 0; k &lt; resultadocuestcat.length; k++) {
        tsest.child(&#x27;puntajecategoria&#x27;).push({
          categoria: resultadocuestcat[k].categoria,
          puntaje: resultadocuestcat[k].puntaje
        });
      }

      idrest &#x3D; tsest.key;

      this.df.database.ref(&#x27;nivelcoeficiente&#x27;)
        .orderByChild(&#x27;ci&#x27;)
        .endAt(puntaje)
        .once(&#x27;value&#x27;)
        .then(function(auxsnapshot) {
          auxsnapshot.forEach(function (auxchildSnapshot) {
            const auxvaluechild &#x3D; auxchildSnapshot.val();

            auxdf.database.ref(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante/&#x27; + estudiante.$key)
              .child(&#x27;nivelcognitivo&#x27;)
              .set(auxvaluechild.estado);

            auxdf.database.ref(&#x27;estudiante_usuario/&#x27; + usuario.id + &#x27;/estudiante/&#x27; + estudiante.$key)
              .child(&#x27;edadmental&#x27;)
              .set(null);

            tsest.child(&#x27;nivelcognitivo&#x27;).set(auxvaluechild.estado);

            return idrest;
          }
        );
      }
      );
    }

    return resultado;
  }

  /**
   *
   * @param {Usuario} usuario
   * @param {*} estudiante
   * @param {string} testeval
   * @memberof AppService
   */
  public export(usuario: Usuario, estudiante: any, testeval: string): void {

    // tslint:disable-next-line:prefer-const
    let auxdf &#x3D; this.df;
    // tslint:disable-next-line:prefer-const
    let auxcaberajson: any[];
    // tslint:disable-next-line:prefer-const
    let auxrespuestasjson: any[];
    // tslint:disable-next-line:prefer-const
    let auxrespuestastipojson: any[];
    // tslint:disable-next-line:prefer-const
    let auxrespuestascategoriajson: any[];
    // tslint:disable-next-line:prefer-const
    let auxResultadojson: any[];
    // tslint:disable-next-line:prefer-const
    let nombrecompleto;

    this.df.database.ref(&#x27;estudiante_usuario/&#x27;
      + usuario.id + &#x27;/estudiante/&#x27;
      + estudiante.$key + &#x27;/testevaluado/&#x27;
      + testeval)
      .once(&#x27;value&#x27;)
      .then(function(auxsnapshot) {
        // tslint:disable-next-line:prefer-const
        let auxcaberajsonx: any[];
        // tslint:disable-next-line:prefer-const
        let auxrespuestasjsonx: any[] &#x3D; [];
        // tslint:disable-next-line:prefer-const
        let auxrespuestastipojsonx: any[];
        // tslint:disable-next-line:prefer-const
        let auxrespuestascategoriajsonx: any[] &#x3D; [];
        // tslint:disable-next-line:prefer-const
        let auxnombrecompleto;

        auxdf.database.ref(&#x27;estudiante_usuario/&#x27;
        + usuario.id + &#x27;/estudiante/&#x27;
        + estudiante.$key)
        .once(&#x27;value&#x27;)
        .then(function(auxchildsnapshot) {
          // tslint:disable-next-line:prefer-const
          auxcaberajsonx &#x3D; [{
            &#x27;Nombres&#x27;: auxchildsnapshot.val().nombres,
            &#x27;Apellidos&#x27;: auxchildsnapshot.val().apellidos,
            &#x27;Cdula de Identificacin&#x27;: auxchildsnapshot.val().ci,
            &#x27;Fecha de Nacimiento&#x27;: auxchildsnapshot.val().fecha_nacimiento,
            &#x27;Sexo&#x27;: auxchildsnapshot.val().sexo,
            &#x27;Fecha Test&#x27;: auxsnapshot.val().fecha}];
          auxnombrecompleto &#x3D; auxchildsnapshot.val().nombres + &#x27; &#x27; + auxchildsnapshot.val().apellidos;
        });

        auxdf.database.ref(&#x27;estudiante_usuario/&#x27;
        + usuario.id + &#x27;/estudiante/&#x27;
        + estudiante.$key + &#x27;/testevaluado/&#x27;
        + testeval + &#x27;/respuestas&#x27;)
        .once(&#x27;value&#x27;)
        .then(function(auxchildrespsnapshot) {
          auxchildrespsnapshot.forEach(function (element) {
            auxrespuestasjsonx.push({
              &#x27;Nmero de Pregunta&#x27;: element.val().numero_pregunta,
              &#x27;Tiempo (segundos)&#x27;: element.val().tiempo,
              &#x27;Puntaje&#x27;: element.val().puntaje
            });
          });
        });

        if (auxsnapshot.val().tipo_test &#x3D;&#x3D;&#x3D; &#x27;-KqMrQPAJJ2H5Q1Pz01v&#x27;) {
          auxrespuestastipojsonx &#x3D; [];

          auxdf.database.ref(&#x27;estudiante_usuario/&#x27;
          + usuario.id + &#x27;/estudiante/&#x27;
          + estudiante.$key + &#x27;/testevaluado/&#x27;
          + testeval + &#x27;/puntajetipopregunta&#x27;)
          .once(&#x27;value&#x27;)
          .then(function(auxchildrespsnapshot) {
            auxchildrespsnapshot.forEach(function (element) {
              auxrespuestastipojsonx.push({
                &#x27;Tipo de Pregunta&#x27;: element.val().tipopregunta,
                &#x27;Puntaje&#x27;: element.val().puntaje,
                &#x27;Puntaje Equivalente&#x27;: element.val().puntosequivalentes
              });
            });
          });
        }

        auxdf.database.ref(&#x27;estudiante_usuario/&#x27;
        + usuario.id + &#x27;/estudiante/&#x27;
        + estudiante.$key + &#x27;/testevaluado/&#x27;
        + testeval + &#x27;/puntajecategoria&#x27;)
        .once(&#x27;value&#x27;)
        .then(function(auxchildrespsnapshot) {
          auxchildrespsnapshot.forEach(function (element) {
            auxrespuestascategoriajsonx.push({
              &#x27;Categora&#x27;: element.val().categoria &#x3D;&#x3D;&#x3D; 0 ? &#x27;Normal&#x27; :
                (element.val().categoria &#x3D;&#x3D;&#x3D; 1 ? &#x27;Puntaje de Escala Verbal&#x27; :
                (element.val().categoria &#x3D;&#x3D;&#x3D; 2 ? &#x27;Puntaje de Escala de Ejecucin&#x27; : &#x27;&#x27;)),
              &#x27;Puntaje&#x27;: element.val().puntaje
            });
          });
        });

        // tslint:disable-next-line:prefer-const
        let auxedad;

        if (auxsnapshot.val().edadmental) {
          // tslint:disable-next-line:prefer-const
          let anios &#x3D; Math.floor(auxsnapshot.val().edadmental / 12);
          // tslint:disable-next-line:prefer-const
          let mes &#x3D; auxsnapshot.val().edadmental % 12;

          auxedad &#x3D; anios + &#x27; Aos, &#x27; + mes + &#x27; Meses&#x27;;
        } else {
          auxedad &#x3D; &#x27;0 Aos&#x27;;
        }

        // tslint:disable-next-line:prefer-const
        let auxResultadojsonx: any[] &#x3D; [{
          &#x27;Coeficiente Intelectual&#x27;: auxsnapshot.val().ci,
          &#x27;Edad Mental&#x27;: auxedad,
          &#x27;Nivel de Aptitud Cognitiva General&#x27;: auxsnapshot.val().nivelcognitivo
        }];

        setTimeout(() &#x3D;&gt; {
          auxcaberajson &#x3D; auxcaberajsonx;
          auxrespuestasjson &#x3D; auxrespuestasjsonx;
          auxrespuestastipojson &#x3D; auxrespuestastipojsonx;
          auxrespuestascategoriajson &#x3D; auxrespuestascategoriajsonx;
          auxResultadojson &#x3D; auxResultadojsonx;
          nombrecompleto &#x3D; auxnombrecompleto;
        }, 500);
      }
    );

    setTimeout(() &#x3D;&gt; {
      this.exportAsExcelFile(
        auxcaberajson,
        auxrespuestasjson,
        auxrespuestastipojson,
        auxrespuestascategoriajson,
        auxResultadojson,
        nombrecompleto);
    }, 550);
  }

  /**
   *
   * @param {any[]} resultadospresg
   * @param {string} excelFileName
   * @memberof AppService
   */
  private exportAsExcelFile(
    datospersonales: any[],
    datosrespuesta: any[],
    datosrespuestatipo: any[],
    datosrespuestacate: any[],
    datosresultado: any[],
    excelFileName: string): void {

    const workbook: XLSX.WorkBook &#x3D; XLSX.utils.book_new();

    const worksheetpersonales: XLSX.WorkSheet &#x3D; XLSX.utils.json_to_sheet(datospersonales);
    this.wrapAndCenterCell(worksheetpersonales.A1);
    this.wrapAndCenterCell(worksheetpersonales.B1);
    this.wrapAndCenterCell(worksheetpersonales.C1);
    this.wrapAndCenterCell(worksheetpersonales.D1);
    this.wrapAndCenterCell(worksheetpersonales.E1);
    this.wrapAndCenterCell(worksheetpersonales.F1);

    const worksheetrespuesta: XLSX.WorkSheet &#x3D; XLSX.utils.json_to_sheet(datosrespuesta);
    this.wrapAndCenterCell(worksheetrespuesta.A1);
    this.wrapAndCenterCell(worksheetrespuesta.B1);
    this.wrapAndCenterCell(worksheetrespuesta.C1);

    XLSX.utils.book_append_sheet(workbook, worksheetpersonales, &#x27;Datos de la Persona&#x27;);
    XLSX.utils.book_append_sheet(workbook, worksheetrespuesta, &#x27;Resumen de Respuestas&#x27;);

    if (datosrespuestatipo) {
      const worksheetrespuestatipo: XLSX.WorkSheet &#x3D; XLSX.utils.json_to_sheet(datosrespuestatipo);
      this.wrapAndCenterCell(worksheetrespuestatipo.A1);
      this.wrapAndCenterCell(worksheetrespuestatipo.B1);
      this.wrapAndCenterCell(worksheetrespuestatipo.C1);

      XLSX.utils.book_append_sheet(workbook, worksheetrespuestatipo, &#x27;Resumen Puntaje Equivalente&#x27;);
    }

    const worksheetrespuestacate: XLSX.WorkSheet &#x3D; XLSX.utils.json_to_sheet(datosrespuestacate);
    this.wrapAndCenterCell(worksheetrespuestacate.A1);
    this.wrapAndCenterCell(worksheetrespuestacate.B1);

    XLSX.utils.book_append_sheet(workbook, worksheetrespuestacate, &#x27;Resumen Categora&#x27;);

    const worksheetresultado: XLSX.WorkSheet &#x3D; XLSX.utils.json_to_sheet(datosresultado);
    this.wrapAndCenterCell(worksheetresultado.A1);
    this.wrapAndCenterCell(worksheetresultado.B1);
    this.wrapAndCenterCell(worksheetresultado.C1);

    XLSX.utils.book_append_sheet(workbook, worksheetresultado, &#x27;Resultado&#x27;);

    const excelBuffer: any &#x3D; XLSXStyle.write(workbook, { bookType: &#x27;xlsx&#x27;, type: &#x27;buffer&#x27; });
    this.saveAsExcelFile(excelBuffer, excelFileName);
  }

  /**
   *
   * @private
   * @param {XLSX.CellObject} cell
   * @memberof AppService
   */
  private wrapAndCenterCell(cell: XLSX.CellObject) {
    const wrapAndCenterCellStyle &#x3D; {
      alignment: { wrapText: true, vertical: &#x27;center&#x27;, horizontal: &#x27;center&#x27; },
      font: { bold: true } };
    this.setCellStyle(cell, wrapAndCenterCellStyle);
  }

  /**
   *
   * @private
   * @param {XLSX.CellObject} cell
   * @param {{}} style
   * @memberof AppService
   */
  private setCellStyle(cell: XLSX.CellObject, style: {}) {
    cell.s &#x3D; style;
  }

  /**
   *
   * @private
   * @param {*} buffer
   * @param {string} fileName
   * @memberof AppService
   */
  private saveAsExcelFile(buffer: any, fileName: string): void {
    const data: Blob &#x3D; new Blob([buffer], {
      type: EXCEL_TYPE
    });
    FileSaver.saveAs(data, fileName + &#x27; export &#x27; + new Date().getTime() + EXCEL_EXTENSION);
  }
}
</code></pre>
    </div>
</div>







                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
           </div>
       </div>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/search/search.js"></script>
       <script src="../js/search/lunr.min.js"></script>
       <script src="../js/search/search-lunr.js"></script>

       <script src="../js/menu.js"></script>
       <script src="../js/libs/highlight.pack.js"></script>
       <script src="../js/libs/highlightjs-line-numbers.min.js"></script>
       <script src="../js/search/search_index.js"></script>
       <script>
            document.addEventListener('DOMContentLoaded', function() {
                hljs.initHighlightingOnLoad();
                hljs.initLineNumbersOnLoad();
            });
       </script>

    </body>
</html>
